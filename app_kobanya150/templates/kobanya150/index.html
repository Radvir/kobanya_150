{% extends 'base_generic.html' %}
{% load static %}

{% block title %}{{ title }}{% endblock %}

{% block content %}
<div class="container">
    <h1>{{ title }}</h1>
    
    {% if user.is_authenticated %}
        <p>Üdvözöljük, {{ user.username }}!</p>
    {% else %}
        <p><a href="{% url 'login' %}">Bejelentkezés</a> a jelentkezéshez</p>
    {% endif %}
    <div>
        
        <h2>Jelenlegi Időszak</h2>
        

        {% for alkalom in alkalmak %}
            <div class="alkalom-item">
                <p><strong>Dátum:</strong> {{ alkalom.datum }}</p>
                <p>{{alkalom.ido_kezdes}}-{{alkalom.ido_vege}}</p>
                <p><strong>Jelentkezők száma:</strong> {{ alkalom.jelentkezok.count }}/{{ alkalom.max_letszam }}</p>
                {% if is_in_any %}
                    {% if user in alkalom.jelentkezok.all %}
                    {% comment %} Lejelentkezés {% endcomment %}

                    <form action="lejelentkezes/{{alkalom.id}}/" method="post">
                        {% csrf_token %}
                        <input type="hidden" name="alkalom_id" value="{{ alkalom.id }}">
                        <button type="submit" class="btn btn-primary">Lejelentkezés</button>
                    </form>

                    {% else %}

                    <form action="atjelentkezes/{{alkalom.id}}/" method="post">
                        {% csrf_token %}
                        <input type="hidden" name="alkalom_id" value="{{ alkalom.id }}">
                        <button type="submit" class="btn btn-primary">Átjelentkezés</button>
                    </form>

                    {% endif %}
                    
                    {% else %}
                    <!--Feljelentkezés-->    
                    <form action="feljelentkezes/{{alkalom.id}}/" method="post">
                        {% csrf_token %}
                        <input type="hidden" name="alkalom_id" value="{{ alkalom.id }}">
                        <button type="submit" class="btn btn-primary">Feljelentkezés</button>
                    </form>
                {% endif %}
            </div>
        {% endfor %}
    </div>
</div>

<style>
.week-item {
    border: 1px solid #ddd;
    padding: 15px;
    margin: 10px 0;
    border-radius: 5px;
}

.btn {
    display: inline-block;
    padding: 8px 16px;
    margin: 5px;
    text-decoration: none;
    border-radius: 4px;
    color: white;
}

.btn-primary {
    background-color: #007bff;
}

.btn-warning {
    background-color: #ffc107;
    color: black;
}

.current-week {
    background-color: #f8f9fa;
    padding: 20px;
    border-radius: 5px;
    margin-bottom: 20px;
}
</style>
{% endblock %}